(clear)
(require scheme/class)
(start-audio "system:capture_1" 512 44100)

;OSC CLIENT/SERVER INIT
(osc-source "8000")
(osc-destination "osc.udp://192.168.1.102:8000")

;DEBUG MODE
(define debug 0)

; + MANTICORE                         
; + GENERATIVE-VJ-FRAMEWORK               
; + HTTP://MANTICORE.DEADMEDIAFM.ORG  

; LOAD VISUAL CLASS
(load "/fluxus/manticore-core/visual_class")

; LOAD VISUALS
(load "/fluxus/manticore-core/visual1")
(load "/fluxus/manticore-core/visual2")
(load "/fluxus/manticore-core/visual3")
(load "/fluxus/manticore-core/visual4")
(load "/fluxus/manticore-core/visual5")
(load "/fluxus/manticore-core/visual6")
(load "/fluxus/manticore-core/visual7")

(define visuals (list 
    (make-object visual1%)
    (make-object visual2%)
    (make-object visual3%)
    (make-object visual4%)
    (make-object visual5%)
    (make-object visual6%)
    (make-object visual7%)    
))

; LOAD FUNCTIONS

(load "/fluxus/manticore-core/function")

; VARIABLES

(define visual_bank 0)
(define visual_off 0)
(define visuals_count (length visuals))

(define fader_control (vector 0 0 0 0))
(define fader_count (vector-length fader_control))

; INIT FUNCTION

(kill_visuals)

; MAIN LOOP

(define (renderchain)
    (receive_osc) ; process osc message
    (select_visual) ;select visual
)

(every-frame (renderchain))